---
export interface Props {
  position?: 'bottom-right' | 'bottom-left' | 'top-right' | 'top-left';
  size?: 'sm' | 'md' | 'lg';
  variant?: 'primary' | 'secondary' | 'success' | 'warning' | 'danger';
  icon: string;
  label?: string;
  href?: string;
  onClick?: string;
  animate?: boolean;
  tooltip?: string;
  class?: string;
}

const {
  position = 'bottom-right',
  size = 'md',
  variant = 'primary',
  icon,
  label,
  href,
  onClick,
  animate = true,
  tooltip,
  class: additionalClasses = '',
  ...props
} = Astro.props;

const positionClasses = {
  'bottom-right': 'fixed bottom-6 right-6 z-50',
  'bottom-left': 'fixed bottom-6 left-6 z-50',
  'top-right': 'fixed top-6 right-6 z-50',
  'top-left': 'fixed top-6 left-6 z-50'
};

const sizeClasses = {
  sm: 'w-12 h-12 text-sm',
  md: 'w-14 h-14 text-base',
  lg: 'w-16 h-16 text-lg'
};

const variantClasses = {
  primary: 'bg-brand-primary-600 hover:bg-brand-primary-700 text-white shadow-brand-primary-500/25',
  secondary: 'bg-brand-secondary-600 hover:bg-brand-secondary-700 text-white shadow-brand-secondary-500/25',
  success: 'bg-green-600 hover:bg-green-700 text-white shadow-green-500/25',
  warning: 'bg-yellow-600 hover:bg-yellow-700 text-white shadow-yellow-500/25',
  danger: 'bg-red-600 hover:bg-red-700 text-white shadow-red-500/25'
};

const baseClasses = `
  inline-flex items-center justify-center
  rounded-full shadow-lg hover:shadow-xl
  transition-all duration-300 ease-in-out
  focus:outline-none focus:ring-4 focus:ring-opacity-50
  group cursor-pointer
  ${animate ? 'hover:scale-110 hover:-translate-y-1 animate-bounce-slow' : ''}
`;

const fabClasses = [
  baseClasses,
  positionClasses[position],
  sizeClasses[size],
  variantClasses[variant],
  additionalClasses
].filter(Boolean).join(' ');

const Tag = href ? 'a' : 'button';
---

<Tag
  class={fabClasses}
  href={href}
  onclick={onClick}
  title={tooltip || label}
  data-tooltip={tooltip}
  {...props}
>
  <i class={`${icon} ${label ? 'mr-2' : ''}`}></i>
  {label && <span class="font-medium">{label}</span>}
  
  <!-- Pulse effect for animation -->
  {animate && (
    <span class="absolute inset-0 rounded-full bg-current opacity-0 group-hover:opacity-20 transition-opacity duration-300"></span>
  )}
</Tag>

<!-- Enhanced CSS for bounce animation -->
<style>
.animate-bounce-slow {
  animation: bounce-slow 3s infinite;
}

@keyframes bounce-slow {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-8px);
  }
}

/* Tooltip styling */
[data-tooltip]:hover:before {
  content: attr(data-tooltip);
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(-8px);
  background: rgba(0, 0, 0, 0.8);
  color: white;
  padding: 0.5rem;
  border-radius: 0.375rem;
  font-size: 0.875rem;
  white-space: nowrap;
  z-index: 1000;
  opacity: 1;
  pointer-events: none;
}

[data-tooltip]:hover:after {
  content: '';
  position: absolute;
  bottom: 100%;
  left: 50%;
  transform: translateX(-50%) translateY(-2px);
  border: 4px solid transparent;
  border-top-color: rgba(0, 0, 0, 0.8);
  z-index: 1000;
}
</style>
